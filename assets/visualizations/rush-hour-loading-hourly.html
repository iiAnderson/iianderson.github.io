<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Rush Hour Reality - Hourly Loading Patterns</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: #1a1a1a;
                color: #e0e0e0;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        @media (prefers-color-scheme: dark) {
            .container {
                background: #2d2d2d;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            }
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1a1a1a;
        }

        @media (prefers-color-scheme: dark) {
            h1 {
                color: #e0e0e0;
            }
        }

        .subtitle {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
        }

        @media (prefers-color-scheme: dark) {
            .subtitle {
                color: #aaa;
            }
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .controls label {
            font-size: 16px;
            font-weight: 500;
        }

        .controls select {
            padding: 8px 35px 8px 12px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: white;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 20px;
            min-width: 200px;
        }

        @media (prefers-color-scheme: dark) {
            .controls select {
                background-color: #3d3d3d;
                border-color: #555;
                color: #e0e0e0;
                background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e0e0e0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            }
        }

        .controls select:hover {
            border-color: #999;
        }

        .controls select:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .chart-container {
            position: relative;
            height: 500px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-box {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #4a90e2;
        }

        @media (prefers-color-scheme: dark) {
            .stat-box {
                background: #3d3d3d;
            }
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        @media (prefers-color-scheme: dark) {
            .stat-label {
                color: #aaa;
            }
        }

        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: #1a1a1a;
        }

        @media (prefers-color-scheme: dark) {
            .stat-value {
                color: #e0e0e0;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 22px;
            }

            .controls {
                flex-direction: column;
                align-items: flex-start;
            }

            .controls select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>The Rush Hour Reality</h1>
        <p class="subtitle">Average train loading throughout the day (October 2025)</p>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Morning Peak (7-8am)</div>
                <div class="stat-value" id="morning-peak">36%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Evening Peak (5-6pm)</div>
                <div class="stat-value" id="evening-peak">33%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Midday Average</div>
                <div class="stat-value" id="midday-avg">19%</div>
            </div>
        </div>

        <div class="controls">
            <label for="view-select">View:</label>
            <select id="view-select">
                <option value="weekday">Weekday vs Weekend</option>
                <option value="toc">By Operator (SE vs CH)</option>
                <option value="all">All Data Combined</option>
            </select>
        </div>

        <div class="chart-container">
            <canvas id="loadingChart"></canvas>
        </div>
    </div>

    <script>
        // Embedded dataset - Weekday averages (Oct 1, 2, 3, 6, 7, 8)
        const weekdayData = [
            {hour: 0, loading: 12.6}, {hour: 1, loading: 8.6}, {hour: 4, loading: 9.5},
            {hour: 5, loading: 18.1}, {hour: 6, loading: 23.1}, {hour: 7, loading: 33.5},
            {hour: 8, loading: 33.9}, {hour: 9, loading: 20.5}, {hour: 10, loading: 19.1},
            {hour: 11, loading: 20.1}, {hour: 12, loading: 19.3}, {hour: 13, loading: 20.6},
            {hour: 14, loading: 22.1}, {hour: 15, loading: 25.3}, {hour: 16, loading: 30.5},
            {hour: 17, loading: 32.9}, {hour: 18, loading: 28.7}, {hour: 19, loading: 19.6},
            {hour: 20, loading: 16.3}, {hour: 21, loading: 14.2}, {hour: 22, loading: 14.9},
            {hour: 23, loading: 14.0}
        ];

        // Weekend averages (Oct 4, 5)
        const weekendData = [
            {hour: 0, loading: 17.5}, {hour: 1, loading: 11.8}, {hour: 4, loading: 11.8},
            {hour: 5, loading: 13.2}, {hour: 6, loading: 12.8}, {hour: 7, loading: 13.7},
            {hour: 8, loading: 14.4}, {hour: 9, loading: 18.5}, {hour: 10, loading: 23.4},
            {hour: 11, loading: 25.4}, {hour: 12, loading: 24.1}, {hour: 13, loading: 20.2},
            {hour: 14, loading: 19.9}, {hour: 15, loading: 18.4}, {hour: 16, loading: 20.1},
            {hour: 17, loading: 24.5}, {hour: 18, loading: 24.7}, {hour: 19, loading: 21.3},
            {hour: 20, loading: 19.9}, {hour: 21, loading: 19.1}, {hour: 22, loading: 16.1},
            {hour: 23, loading: 17.0}
        ];

        // Southeastern data (Oct 7)
        const seData = [
            {hour: 0, loading: 10.4}, {hour: 1, loading: 5.8}, {hour: 4, loading: 10.5},
            {hour: 5, loading: 19.8}, {hour: 6, loading: 26.3}, {hour: 7, loading: 37.0},
            {hour: 8, loading: 36.4}, {hour: 9, loading: 21.8}, {hour: 10, loading: 18.3},
            {hour: 11, loading: 18.9}, {hour: 12, loading: 18.0}, {hour: 13, loading: 19.3},
            {hour: 14, loading: 21.4}, {hour: 15, loading: 24.6}, {hour: 16, loading: 31.6},
            {hour: 17, loading: 33.3}, {hour: 18, loading: 29.4}, {hour: 19, loading: 19.5},
            {hour: 20, loading: 17.0}, {hour: 21, loading: 13.5}, {hour: 22, loading: 14.3},
            {hour: 23, loading: 12.2}
        ];

        // Chiltern data (Oct 7)
        const chData = [
            {hour: 0, loading: 4.9}, {hour: 5, loading: 6.3}, {hour: 6, loading: 21.6},
            {hour: 7, loading: 28.7}, {hour: 8, loading: 27.8}, {hour: 9, loading: 21.5},
            {hour: 10, loading: 28.5}, {hour: 11, loading: 26.0}, {hour: 12, loading: 27.0},
            {hour: 13, loading: 25.4}, {hour: 14, loading: 24.4}, {hour: 15, loading: 31.2},
            {hour: 16, loading: 34.1}, {hour: 17, loading: 40.4}, {hour: 18, loading: 34.8},
            {hour: 19, loading: 28.3}, {hour: 20, loading: 24.0}, {hour: 21, loading: 25.2},
            {hour: 22, loading: 14.5}, {hour: 23, loading: 12.7}
        ];

        const ctx = document.getElementById('loadingChart').getContext('2d');
        let chart;

        const viewSelect = document.getElementById('view-select');

        function createChart(datasets) {
            if (chart) {
                chart.destroy();
            }

            const isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
            const textColor = isDark ? '#e0e0e0' : '#666';

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 24}, (_, i) => {
                        if (i === 0) return '12am';
                        if (i < 12) return `${i}am`;
                        if (i === 12) return '12pm';
                        return `${i-12}pm`;
                    }),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                color: textColor,
                                font: {
                                    size: 14
                                },
                                usePointStyle: true,
                                padding: 15
                            }
                        },
                        tooltip: {
                            backgroundColor: isDark ? 'rgba(45, 45, 45, 0.95)' : 'rgba(255, 255, 255, 0.95)',
                            titleColor: textColor,
                            bodyColor: textColor,
                            borderColor: gridColor,
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y.toFixed(1)}% capacity`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 45,
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: {
                                    size: 12
                                },
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            title: {
                                display: true,
                                text: 'Average Train Loading (%)',
                                color: textColor,
                                font: {
                                    size: 14,
                                    weight: '500'
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateChart() {
            const view = viewSelect.value;
            let datasets = [];

            if (view === 'weekday') {
                datasets = [
                    {
                        label: 'Weekday',
                        data: weekdayData.map(d => d.loading),
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6
                    },
                    {
                        label: 'Weekend',
                        data: weekendData.map(d => d.loading),
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6
                    }
                ];
            } else if (view === 'toc') {
                datasets = [
                    {
                        label: 'Southeastern',
                        data: seData.map(d => d.loading),
                        borderColor: '#e67e22',
                        backgroundColor: 'rgba(230, 126, 34, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6
                    },
                    {
                        label: 'Chiltern',
                        data: Array(24).fill(null).map((_, i) => {
                            const match = chData.find(d => d.hour === i);
                            return match ? match.loading : null;
                        }),
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        spanGaps: true
                    }
                ];
            } else {
                datasets = [
                    {
                        label: 'All Services',
                        data: weekdayData.map(d => d.loading),
                        borderColor: '#2ecc71',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6
                    }
                ];
            }

            createChart(datasets);
        }

        viewSelect.addEventListener('change', updateChart);

        // Listen for dark mode changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateChart);

        // Initial chart
        updateChart();
    </script>
</body>
</html>
